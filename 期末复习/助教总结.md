# 并行处理

## 题型
- 全是简答题，言之有理即可
- 存储一致性几个协议看一下

## 题目列表
1. 从上层应用出发的并行程序的两种通用模型是什么？请列出并分别解释这两种模型。
2. 列出现代处理器并行执行的主要形式，并分别解释。
3. 分析多线程的收益和代价，并举例吞吐导向的多线程代表架构。
4. Flynn 分类法是如何对并行分类的？
5. 多核有哪几种通信方式？
6. 列举减少访存延迟和隐藏访存延迟的方法。
7. SMP 和 NUMA 架构分别是什么，各自有什么优缺点。
8. 并行编程模型分别是哪三种，并分别阐述三种模型各自的特点。
9. 请举一个常用的混合编程模型的例子？其好处是什么？
10. 基于共享地址空间的通用同步原语有哪些？具体进行解释。
11. 在讨论局部性时会从哪两个维度上进行讨论，两种局部性分别指的是什么，cache 利用了哪种局部性原理？
12. 导致 cache miss 的原因是什么？并分析如何避免/减少每种 cache miss？
13. 请列举出降低通信开销的几种方法？
14. 并行编程中，造成竞争的原因有哪些，如何减小竞争？
15. 介绍为了使工作负载更均衡，在任务调度时可以采取的机制，以及可能的困难。
16. 导致应用可扩展性差的因素有哪些？并从中选出两个因素分析如何发现这种因素以及如何解决？
17. 请解释强可扩展性和弱可扩展性。
18. 导致并行计算无法达到理想加速比的并行性能开销有哪些？
19. 请画出 VGG 和 MobileNet 两个神经网络模型推理对应的 roofline 模型，并标出 VGG 和 MobileNet 在图中的位置。
20. 请结合 roofline 模型，在下述配置的处理器中优化 Stencil 程序。
21. 请简述并行程序 Benchmark 的选取原则是什么。
22. SIMD 和 SIMT 架构分别是什么，请分别解释。
23. 简述线程分组的两种方式，并分析动态线程分组的缺点。
24. 介绍一下 CUDA 编程中，并发线程的层次结构，以及 CUDA 对并行提供的支撑。
25. 请列举至少三种提高 CUDA 代码效率的方法。
26. 列举四种常见的共享存储多处理器架构，并分别解释。
27. 解释存储一致性模型、顺序一致性模型。
28. 在顺序同一性下，(A,B)的可能结果包括哪几种？并举例说明对应的实际执行顺序（每种结果举 1 个例子即可）。不可能的结果是什么？如果实际执行的顺序是 1b->1a->2b->2a，满足顺序同一性吗？解释原因。
29. 举例几种常见的互联拓扑结构，并给出其网络直径和和对分带宽分析。
30. 论述互连网络中，死锁出现的原因和避免的方法，给出一种避免方法的示例。
31. 片上网络的流控按粒度划分可以分为哪几类，并分别介绍一种对应的流控技术
32. 分析 N 维、每维上有 k 个节点的 Torus 片上互连拓扑结构的对分带宽、饱和吞吐、网络直径和平均跳步。
33. 列举常用的利用空间局部性的方法。
34. 列举事务性内存的优势。
</br>

## 题目解答

### 1. 从上层应用出发的并行程序的两种通用模型是什么？请列出并分别解释这两种模型。
![alt text](./pic/02f22bbbce85849c2f2f56076fbb361.jpg)
从上层应用出发的并行程序有两种通用模型：数据并行模型和任务并行模型。

1. **数据并行模型**
   - **解释**：在数据并行模型中，重点是对数据进行划分，多个处理器同时对不同的数据部分执行相同的操作。例如，在一个图像处理程序中，要对一幅高分辨率的图像进行滤波处理。可以将图像分割成多个子区域（比如按照行或者列划分），每个处理器负责处理一个子区域。所有处理器执行的滤波算法是完全相同的，只是处理的数据不同。这种并行方式可以显著提高处理大规模数据的速度，因为它充分利用了多个处理器的计算能力来同时处理数据的不同部分。数据并行模型的核心在于数据的划分策略和在不同处理器上的同步机制。在实际应用中，需要考虑如何划分数据才能使负载平衡，也就是让每个处理器的工作量大致相同，避免有的处理器闲置，有的处理器负担过重的情况。同时，在处理过程中可能需要在合适的时间点进行同步，例如在完成一个阶段的计算后，需要将各个处理器处理的结果进行汇总或者合并，这就要求有良好的通信和同步机制。
2. **任务并行模型**
   - **解释**：任务并行模型强调的是将一个大的任务分解为多个相对独立的子任务，这些子任务可以在不同的处理器上同时执行。以一个复杂的三维游戏渲染为例，渲染场景包括地形渲染、角色渲染、光影效果渲染等多个任务。这些任务之间有一定的独立性，可以分配给不同的处理器同时进行。每个处理器负责一个特定的任务，并且这些任务之间可能存在一定的依赖关系和通信需求。例如，角色的光影效果可能依赖于地形的光照信息。任务并行模型的关键在于任务的分解和任务之间的协调。要合理地将一个大任务分解成可以并行执行的子任务，需要对应用程序的功能和流程有深入的理解。同时，要处理好子任务之间的依赖关系，确保在需要某个子任务的结果来进行后续任务时，这个结果能够及时、正确地传递和使用，这涉及到处理器之间的通信和同步机制，以及任务调度策略。
</br>

### 2. 列出现代处理器并行执行的主要形式，并分别解释。
![alt text](./pic/6e2bb990ed9720bc62903c88e9a269c.jpg)
</br>

### 3. 分析多线程的收益和代价，并举例吞吐导向的多线程代表架构。
![alt text](./pic/769c07c05f8993825d2bd70f807003c.jpg)
![alt text](./pic/bbe138436eff5e6251d5cea57eba141.jpg)
</br>

### 4. Flynn 分类法是如何对并行分类的？
![alt text](./pic/b2fd5fbf0f6f36de85e91e8efc7835f.jpg)
</br>

### 5. 多核有哪几种通信方式？
![alt text](./pic/9ed1fe0f0481e5a46a2cf4acda83611.jpg)
</br>

### 6. 列举减少访存延迟和隐藏访存延迟的方法。
![alt text](./pic/7d2c11989739e4352e02ca3ac301e3d.jpg)
</br>

### 7. SMP 和 NUMA 架构分别是什么，各自有什么优缺点。
![alt text](./pic/bcc8d26214252a8950a363295b60983.jpg)
</br>

### 8. 并行编程模型分别是哪三种，并分别阐述三种模型各自的特点。
![alt text](./pic/db4241809c39588cbc8f6788dc08d3a.jpg)
![alt text](./pic/b965a55b399f6df95f812dd0bbf7c74.jpg)
</br>

### 9.  请举一个常用的混合编程模型的例子？其好处是什么？
![alt text](./pic/9144f6446c94b978b40e23ffa7de555.jpg)
</br>

### 10. 基于共享地址空间的通用同步原语有哪些？具体进行解释。
![alt text](./pic/da8b366457436ba02573e039c1284eb.jpg)
</br>

### 11. 在讨论局部性时会从哪两个维度上进行讨论，两种局部性分别指的是什么，cache 利用了哪种局部性原理？
![alt text](./pic/9121b0d3327c8f56a77207a77c8db2c.jpg)
</br>

### 12. 导致 cache miss 的原因是什么？并分析如何避免/减少每种 cache miss？
![alt text](./pic/b8b8500d732fe66afbd1baae3abcb96.jpg)
</br>

### 13. 请列举出降低通信开销的几种方法？
![alt text](./pic/f03d49e3045bd4d66a2773ddeb8d435.jpg)
</br>

### 14. 并行编程中，造成竞争的原因有哪些，如何减小竞争？
![alt text](./pic/89cc7d9d291cd976123ea8ea12879f6.jpg)
</br>

### 15. 介绍为了使工作负载更均衡，在任务调度时可以采取的机制，以及可能的困难。
![alt text](./pic/04976b353b17d1410aef51bace9586f.jpg)
</br>

### 16. 导致应用可扩展性差的因素有哪些？并从中选出两个因素分析如何发现这种因素以及如何解决？
![alt text](./pic/60ab3c8f419afa93d02598a8718015f.jpg)
</br>

### 17. 请解释强可扩展性和弱可扩展性。
![alt text](./pic/4aedb1e8edb5060dd8078994e1c18f3.jpg)
</br>

### 18. 导致并行计算无法达到理想加速比的并行性能开销有哪些？
![alt text](./pic/56831f105207c304d0dbd30dc64ae45.jpg)
</br>

### 19. 请画出 VGG 和 MobileNet 两个神经网络模型推理对应的 roofline 模型，并标出 VGG 和 MobileNet 在图中的位置。（重点，计算题会至少考一个）
![alt text](./pic/6c31176f56b63176c9ae36e070916c7.jpg)
</br>

### 20. 请结合 roofline 模型，在下述配置的处理器中优化 Stencil 程序。（重点，计算题会至少考一个）
![alt text](./pic/28a865bdd9997c338d3d04b199763ab.jpg)
</br>

### 21. 请简述并行程序 Benchmark 的选取原则是什么。
![alt text](./pic/b1164d9ebeb0f2c2e3fe1d0c41bd436.jpg)
</br>

### 22. SIMD 和 SIMT 架构分别是什么，请分别解释。
![alt text](./pic/69364c42a3ac9e1731689b0121fdb3e.jpg)
</br>

### 23. 简述线程分组的两种方式，并分析动态线程分组的缺点。
![alt text](./pic/051aecd21e93614f22c73122b961960.jpg)
</br>

### 24. 介绍一下 CUDA 编程中，并发线程的层次结构，以及 CUDA 对并行提供的支撑。
![alt text](./pic/babd31d6fe76f8dcd12e76101d2ef93.jpg)
</br>

### 25. 请列举至少三种提高 CUDA 代码效率的方法。
![alt text](./pic/ab422b86333acaa52e6851438efd5d9.jpg)
</br>

### 26. 列举四种常见的共享存储多处理器架构，并分别解释。
![alt text](./pic/6006a871d24f70d6395dcc6b0313a20.jpg)
</br>

### 27. 解释存储一致性模型、顺序一致性模型。（比较重要，可能会考）
![alt text](./pic/bab99182ca3f93523d576b0b4f438d0.jpg)
</br>

### 28. 在顺序同一性下，(A,B)的可能结果包括哪几种？并举例说明对应的实际执行顺序（每种结果举 1 个例子即可）。不可能的结果是什么？如果实际执行的顺序是 1b->1a->2b->2a，满足顺序同一性吗？解释原因。（重点，计算题会至少考一个）
![alt text](./pic/56bf63e76e46f036ed8389db48d094e.jpg)
</br>

### 29. 举例几种常见的互联拓扑结构，并给出其网络直径和和对分带宽分析。
![alt text](./pic/22ba62b9a8aff91be60f3ddc162213b.jpg)
</br>

### 30. 论述互连网络中，死锁出现的原因和避免的方法，给出一种避免方法的示例。
![alt text](./pic/180f737d10ba99ebf1102629a5328c7.jpg)
</br>

### 31. 片上网络的流控按粒度划分可以分为哪几类，并分别介绍一种对应的流控技术
![alt text](./pic/3c53143a763e4d1941ab5c31d796487.jpg)
</br>

### 32. 分析 N 维、每维上有 k 个节点的 Torus 片上互连拓扑结构的对分带宽、饱和吞吐、网络直径和平均跳步。
![alt text](./pic/2df3765cb62ef44c729b95c89d7597a.jpg)
![alt text](./pic/d81c9d42f165652be8aaacbe64539ad.jpg)
![alt text](./pic/ba76173c749bf9394e976e1feef959f.jpg)
</br>

### 33. 列举常用的利用空间局部性的方法。
![alt text](./pic/c133691ac5d04f6b280d2d9e1a03249.jpg)
</br>

### 34. 列举事务性内存的优势。
![alt text](./pic/014276f361c2de2d36c015b06103f7a.jpg)
</br>

### 其他
![alt text](./pic/20e0e1e739ac035f08980ab786f318a.jpg)
![alt text](./pic/f548d57e3f9e3a2df8db171dc4714ec.jpg)
![alt text](./pic/e55bdbfb536af316f0ae4fa9b20562a.jpg)
![alt text](./pic/650464459deda81d2a2fc407b3ed45a.jpg)

